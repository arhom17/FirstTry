---
title: "Graphs"
author: "Alex Rhomberg"
date: "10/30/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggformula)
library(png)
library(ggpubr)
library(grid)
```

## R Markdown

```{r}
img <- png::readPNG("soccerfield.png")
```


```{r Long Ball}
#longBallClean %>% gf_bin2d(longbally ~ longballx, color =~ LongBallSuccess, binwidth = c(0.9,1.9)) %>% gf_jitter(longbally ~ longballx, color =~ LongBallSuccess, width = .25, height = .5, position = "jitter")+ scale_fill_continuous(guide = FALSE) + annotation_custom(rasterGrob(img, width = unit(0.82, "npc"),height = unit(1.1,"npc")),-Inf, Inf, -Inf, Inf) + lims(x=c(0.35,4.1), y = c(-.15,6))

#ADD JITTER TO ORIGINAL POINTS INSTEAD?
```

```{r Long Ball Success Rates}
longBallClean %>%  group_by(LongBallSuccess) %>% 
  count() %>% spread(LongBallSuccess, n) %>% mutate(Tries = `1`+`2`,
    SuccessRate = `1`/Tries) %>% rename(Successes = `1`, Fails = `2`) 
```


```{r Long Ball Successs Rate by Player}
longBallClean %>%  group_by(LongBall, LongBallSuccess) %>% 
  count() %>% spread(LongBallSuccess, n) %>% 
  mutate( `1` = replace_na(`1`,0),
          `2` = replace_na(`2`,0)) %>%
  mutate(Tries = `1`+`2`,
    SuccessRate = `1`/Tries ) %>%
  rename(JerseyNumber = LongBall,
         Successes = `1`,
         Fails = `2`) %>%
  arrange(desc(Successes, SuccessRate))  
```


```{r Key Pass}
keyPassClean %>% gf_jitter(keyPassy ~ keyPassx,width = 1, height = 1) + scale_fill_continuous(guide = FALSE) + annotation_custom(rasterGrob(img, width = unit(0.82, "npc"),height = unit(1.1,"npc")),-Inf, Inf, -Inf, Inf) + lims(x=c(-0.6,4.6), y = c(0,5))
```

```{r Take On}
takeOnClean %>% gf_jitter(takeOny ~ takeOnx, width = 1, height = 1) + scale_fill_continuous(guide = FALSE) + annotation_custom(rasterGrob(img, width = unit(0.82, "npc"),height = unit(1.1,"npc")),-Inf, Inf, -Inf, Inf) + lims(x=c(-0.6,4.6), y = c(0,5))
```

```{r Steal}
stealClean %>% gf_bar( ~ Steal, color =~ StealHow ,width = 1, height = 1)
#Fix labs and add rug?
```

```{r Tackle}
tackleClean %>% gf_bar( ~ Tackle, color = ~TackleHow,width = 1, height = 1)
#Fix labs and add rug?
```

```{r Turnover}
turnoverClean %>% gf_jitter(turnovery ~ turnoverx, width = 1, height = 1) + scale_fill_continuous(guide = FALSE) + annotation_custom(rasterGrob(img, width = unit(0.82, "npc"),height = unit(1.1,"npc")),-Inf, Inf, -Inf, Inf) + lims(x=c(-0.6,4.6), y = c(0,5))
```

```{r Pressure}
pressureClean %>% gf_jitter(pressurey ~ pressurex, color =~ PressureSuccess, width = 1, height = 1) + scale_fill_continuous(guide = FALSE) + annotation_custom(rasterGrob(img, width = unit(0.82, "npc"),height = unit(1.1,"npc")),-Inf, Inf, -Inf, Inf) + lims(x=c(-0.6,4.6), y = c(0,5))
```